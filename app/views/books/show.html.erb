<% provide :title, @book.title %>
<h2><%= @book.title %></h2>
<div class="row">
  <aside class="col-md-4">
    <section class="user_info">
      <%= render 'devise/shared/user_info' %>
    </section>
    <section>
      <%= render 'devise/shared/stats' %>
    </section>
  </aside>
  <div class="col-md-8">
    <div class="col-md-12 well">
      <div class="col-md-4">
        <img id="book-image" src="<%= @book.image %>" />
      </div>
      <div class="col-md-8">
        <div class="col-md-12"><label>Title : </label><%= @book.title %></div>
        <div class="col-md-12"><label>Author : </label><%= @book.author %></div>
        <div class="col-md-12">
          <label>Rate : </label>
          <span id="rate-book"><%= @book.average_rating.round 2 if @book.reviews.any? %></span>
        </div>
        <div class="col-md-12">
          <span id="book_state"><label>State : </label><%= @book.state current_user %></span>
          <%= link_to "change", new_or_edit_book_book_state_path(@book, @book_state), remote: true %>
        </div>
        <div id="book_state_form" class="col-md-12"></div>
        <div id="favorite_state" class="col-md-12">
          <label>Favorite : </label><%= "#{current_user.favorite? @book}" %>
        </div>
        <div id="favorite_form" class="col-md-12">
          <%= render current_user.favorite?(@book)  ? "favorites/remove_favorite" 
                                                    : "favorites/add_favorite" %>
        </div>
      </div>
    </div>
    <div class="col-md-12">
      <h3>Images</h3>
        <strong>
          <div id="count">Has <%= @book.photos.count %> images</div>
        </strong>
        <div class="col-md-12 well">
          <%= render @book.photos %>
        </div>
    </div>
    <div class="col-md-12">
      <h3>Reviews</h3>
        <strong><div id="count">Has <%= @reviews.count %> reviews</div></strong>
        <div id="reviews" class="col-md-12 well">
          <%= render @reviews %>
        </div>
      <h3>Write your review</h3>
      <div class="col-md-12 well">
        <%= render "reviews/form" %>
      </div>
    </div>
  </div>
</div> 